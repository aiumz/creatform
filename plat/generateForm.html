<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>创建表单</title>
    <!--<link href="../plugin/bootstrap-3.3.5-dist/css/bootstrap.min.css"/>-->
    <link href="../plugin/bootstrap-3.3.5-dist/css/bootstrap.css" rel="stylesheet"/>
    <link href="../plugin/My97DatePicker/skin/WdatePicker.css" rel="stylesheet"/>
    <link href="../theme/style.css" rel="stylesheet"/>
    <link href="../theme/print-form.css" rel="stylesheet"/>
    <link rel="stylesheet" href="../plugin/socialShare-master/css/share.css" type="text/css"/>

</head>
<body>
<div>
    <div class="sjmf-edit-form">
        <div class="sjmf-form-step">
            <p class="formBuilder-title"><span><em class="step-num">1</em></span>选择模板</p>
            <p class="formBuilder-line"></p>
            <p class="formBuilder-title active"><span><em class="step-num ">2</em></span>设计表单</p>
            <p class="formBuilder-line"></p>
            <p class="formBuilder-title"><span><em class="step-num active">3</em></span>生成表单</p>
        </div>
    </div>
    <div class="form-interim">
        <div class="sjmf-btn-yl">
            <a class="btn btn-default scbd-btn-edit" href="editForm.html">编辑表单</a>
            <a class="btn btn-default scbd-btn-view">预览表单</a>
            <a class="btn btn-default scbd-btn-form" href="index.html">返回列表</a>
        </div>
    </div>
    <div class="formBuilder-step3-content">
        <div class="formRelease-item">
            <p class="formBuilder-step3-title">网页式表单</p>
            <div class="shareForm-icon">
                <span>分享到：</span>
                <div class="socialShare">
                    <a id="shareweixin" class="msb_network_button weixin " target="_blank">分享到微信</a>
                    <a id="shareqZone" class="msb_network_button qZone" target="_blank">分享到qq空间</a>
                    <a id="shareQQ" class="msb_network_button tQQ" target="_blank">分享到腾讯微博</a>
                    <a id="sharesina" class="msb_network_button sina" target="_blank">分享到新浪微博</a>
                    <a id="sharedouban" class="msb_network_button douban" target="_blank">分享到豆瓣</a>
                </div>

            </div>
            <a class="btn btn-green shareFormSetting btn-sm" data-toggle="modal" data-target="#myModal">微信分享设置</a>
            <p class="formBuilder-step3-tip">你可以将下面的地址分享给好友，或者通过邮件的方式发送出去。</p>
            <input class="form-control formBuilder-step3-input fe_text" id="copyurl" value="http://www.baidu.com"/>
            <a class="btn btn-primary btn_step3_copyURL btn-sm clip_button" data-clipboard-action="copy"
               data-clipboard-target="#copyurl">复制URL地址</a>
            <a class="btn btn-primary btn_step3_view btn-sm">新窗口预览</a>
            <p class="sjmf-bd-ewm">
                <img src="../images/erwerma.png">
            </p>
        </div>
        <div class="formRelease-item">
            <p class="formBuilder-step3-title">嵌入式表单</p>
            <p class="formBuilder-step3-tip">将下面的代码加入到网页HTML代码中，让用户在浏览你的网站时填写表单。</p>
            <textarea class="formBuilder-step3-textarea fe_text" id="copcode"><iframe height="600"
                                                                                      allowTransparency="true"
                                                                                      style="width:100%;border:none;overflow:auto;"
                                                                                      frameborder="0"
                                                                                      src="http://form.mikecrm.com/YLOtK2"></iframe></textarea>
            <a class="btn btn-primary shareFormSetting btn-sm clip_button" data-clipboard-action="copy"
               data-clipboard-target="#copcode">复制代码</a>
            <div class="formViewExample-embed" style="top: 45px;"></div>
        </div>
        <div class="formRelease-item">
            <p class="formBuilder-step3-title">悬浮式表单</p>
            <p class="formBuilder-step3-tip">将下面的代码加入到网页HTML代码中，让用户在点击按钮时查看表单</p>
            <textarea class="form-control formBuilder-step3-textarea fe_text" id="copcode1"><a
                    href="http://form.mikecrm.com/YLOtK2"
                    style="position:fixed;z-index:999;right:-5px;bottom: 20px;display: inline-block;width: 20px;border-radius: 5px;color:white;font-size:14px;line-height:17px;background: #2476CE;box-shadow: 0 0 5px #666;word-wrap: break-word;padding: 10px 6px;border: 2px solid white;">查看表单</a></textarea>
            <a class="btn btn-primary shareFormSetting btn-sm clip_button" data-clipboard-action="copy"
               data-clipboard-target="#copcode1">复制代码</a>
            <div class="formViewExample_fixed"></div>
        </div>
        <div class="formRelease-item">
            <p class="formBuilder-step3-title">打印表单</p>
            <p class="formBuilder-step3-tip" style="display: inline-block">将表单打印成纸质文件进行填写。</p>
            <a class="btn btn-primary btn-sm" id="dayingongneng">打印</a>
        </div>
    </div>
</div>

<div id="copySuccess">复制成功</div>

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="myModalLabel">
                    自定义微信分享的文字
                </h4>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="btwz">标题文字</label>
                    <input type="text" class="form-control" id="btwz" value="空白的表单">
                </div>
                <div class="form-group">
                    <label for="fxms">分享描述</label>
                    <input type="text" class="form-control" id="fxms" value="从头开始创建您的表单">
                </div>

            </div>
            <div class="modal-footer text-center">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消
                </button>
                <button type="button" class="btn btn-primary">
                    保存
                </button>
            </div>
        </div>
    </div>
</div>
<div style="display: none" >
    <div id="print_content">

    </div>
</div>
<script src="../js/jquery.min.js"></script>
<script src="../js/style.js"></script>
<script src="../plugin/My97DatePicker/WdatePicker.js"></script>
<script src="../plugin/My97DatePicker/lang/zh-cn.js"></script>
<script src="../plugin/bootstrap-3.3.5-dist/js/bootstrap.min.js"></script>
<script src="../plugin/socialShare-master/js/share.js" type="text/javascript"></script>
<script type="text/javascript" src="../plugin/clipboard.js-master/dist/clipboard.min.js"></script>
<script src="http://code.jquery.com/jquery-migrate-1.1.0.js"></script>
<script type="text/javascript" src="../plugin/dayin/jquery.jqprint-0.3.js"></script>
<script>
    $(function () {
        $("#shareQQ").on("click", function () {
            $(this).socialShare("tQQ");
        });
        $("#shareweixin").on("click", function () {
            $(this).socialShare("weixinShare");
        });
        $("#shareqZone").on("click", function () {
            $(this).socialShare("qZone");
        });
        $("#sharesina").on("click", function () {
            $(this).socialShare("sinaWeibo");
        });
        $("#sharedouban").on("click", function () {
            $(this).socialShare("doubanShare");
        });

        var clipboard = new Clipboard('.clip_button');

        clipboard.on('success', function (e) {
            $('#copySuccess').fadeToggle(1000);
            setTimeout($('#copySuccess').fadeToggle("slow"), 5000);
        });

        clipboard.on('error', function (e) {
            //console.log(e);
        });
        $('.btn_step3_view').on('click', function () {
            var url = $('#copyurl').val();
            window.open(url);
        })
        var $form_id = "3"
        var _html="http://120.76.138.42:8099";
        $.get(_html+"/form.php/index/getform/id/" + $form_id, function (data) {
            console.log(data)
            var _html;
            _html = '<h2>' + data.title + '</h2>';
            _html += '<p>' + data.description + '</p>';
            var $printhtml = [];//存放需要解析的控件
            var $img = [];//存放图片控件
            var $num = [];//存放图片控件在$printhtml数组中的位置
            for (var i = 0; i < data.body.length; i++) {
                var $comtype = data.body[i].componenttype;
                if ($comtype != "fileUpload" && $comtype != "page"&& $comtype != "shopping") {
                    if ($comtype == "picture") {
                        $num.push($printhtml.length);
                        $img.push(data.body[i]);
                    } else {
                        $printhtml.push(data.body[i]);
                    }
                }
            }
            for (var j = 0; j < $printhtml.length; j++) {
                var $config = JSON.parse(decodeURI($printhtml[j].config));
                console.log($config);
                var $requir="";
                if($config.required=="true"){
                    $requir="(必填)";
                }
                //console.log($requir)
                var $choice="";
                var $item="";
                var $imgchoice="";
                switch ($config.componenttype){
                    case "dropDown":
                    case "radio":
                        for(var n=0;n<$config.itemList.length;n++){
                            $choice+='<label class="checkbox-inline"><input type="radio">'+$config.itemList[n].name +'</label>'
                        }
                        $item=$choice;
                        break;
                    case "checkBox":
                        for(var n=0;n<$config.itemList.length;n++){
                            $choice+='<label class="checkbox-inline"><input type="checkbox">'+$config.itemList[n].name +'</label>'
                        }
                        $item=$choice;
                        break;
                    case "pictureRadio":
                        for(var n=0;n<$config.itemList.length;n++){
                            $imgchoice+='<li class="img-radio"> <div class="img-box"><img src="'+$config.itemList[n].src+'"></div><label class="checkbox-inline"><input type="radio" name="optionsRadiosinline"  class="img-radio-option"><span class="radioName">'+$config.itemList[n].name +'</span></label></li>'
                        }
                        $item='<ul class="clearfix p-l-0 radio labelList">'+$imgchoice+'</ul>';
                        break;
                    case "pictureCheckedBox":
                        for(var n=0;n<$config.itemList.length;n++){
                            $imgchoice+='<li class="img-radio"> <div class="img-box"><img src="'+$config.itemList[n].src+'"></div><label class="checkbox-inline"><input type="checkbox" name="optionsRadiosinline"  class="img-radio-option"><span class="radioName">'+$config.itemList[n].name +'</span></label></li>'
                        }
                        $item='<ul class="clearfix p-l-0 radio labelList">'+$imgchoice+'</ul>';
                        break;
                        break;
                    case "date":
                        $item='<div><span class="data-input"></span>年<span class="data-input"></span>月<span class="data-input"></span>日</div>'
                        break;
                    case "star"://评分
                        var $th="";
                        var $td="";
                        for(var n=0;n<$config.starLength;n++){
                            var $thnum =  parseInt(n)+1;
                            $th+='<th>'+ $thnum+'</th>';
                            $td+='<td></td>'
                        }
                        $item ='<table class="form-table"><tr class="form-tr">'+ $th+'</tr><tr class="form-tr">'+ $td+'</tr></table>'
                        break;
                   /* case "shopping":
                        break;*/
                    case "section"://分割线
                        $item="<hr/>";
                        break;
                    default:
                        $item="<div>"+$config.title+$requir+"</div>";
                        $item="<div class='form-desc'>"+$config.desc+"</div>";
                        $item="<div class='dotted-input'></div>";
                        break;
                }
                for (var k = 0; k < $num.length; k++) {
                    if (j == $num[k]) {//当控件为图片时
                        _html += 'pic';
                       // _html += '<div><p><span>' + (parseInt(j) + 1) + '</span><span>' + $config.title + '</span></p><p>' + $config.desc+ '</p>'+$item+'</div>';
                    } else {
                        _html += '<div class="like-li-print"><p><span>' + (parseInt(j) + 1) + '</span><span>' + $config.title + '</span></p><p>' + $config.desc+$requir + '</p>'+$item+'</div>';
                    }
                }
            }
            $('#print_content').html(_html);
        })
        $('#dayingongneng').on('click', function () {
            $('#print_content').jqprint();
        })

    })

</script>
</body>
</html>